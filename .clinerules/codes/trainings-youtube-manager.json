{
  "id": "trainings-youtube-manager",
  "title": "Trainings YouTube Manager",
  "tech": "React",
  "language": "typescript",
  "description": "Página de treinamentos com CRUD de vídeos do YouTube armazenados no localStorage.",
  "content_type": "code",
  "card_type": "codigos",
  "screens": [
    {
      "name": "Trainings.tsx",
      "description": "Interface principal com busca, grid de vídeos e modal de adição/edição.",
      "route": "cards/trainings/page",
      "order": 0,
      "blocks": [
        {
          "id": "8db5e1a3-8c49-42a0-83fa-66c72d7d8e54",
          "type": "code",
          "title": "Trainings.tsx",
          "language": "typescript",
          "order": 0,
          "content": "\"use client\"\n\nimport { useState } from \"react\"\nimport { Input } from \"@/components/ui/input\"\nimport { Search, Video, Pencil, Trash2 } from \"lucide-react\"\nimport { useTrainingVideos } from \"@/hooks/useTrainingVideos\"\nimport YouTubeVideo from \"@/components/youtube-video\"\nimport AddVideoSheet from \"@/components/add-video-sheet\"\nimport AulasMenu from \"@/components/aulas-menu\"\nimport { Button } from \"@/components/ui/button\"\n\nexport default function Trainings() {\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const [isAddVideoOpen, setIsAddVideoOpen] = useState(false)\n\n  const trainingVideos = useTrainingVideos()\n\n  // Filter videos by search term\n  const filteredVideos = trainingVideos.videos.filter(video =>\n    video.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    (video.description && video.description.toLowerCase().includes(searchTerm.toLowerCase()))\n  )\n\n  // Handle add video\n  const handleAddVideo = async (data: { title: string; url: string; description?: string }) => {\n    await trainingVideos.createVideo({\n      title: data.title,\n      youtubeUrl: data.url,\n      description: data.description\n    })\n    setIsAddVideoOpen(false)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Menu */}\n      <AulasMenu onAddVideo={() => setIsAddVideoOpen(true)} />\n\n      {/* Search */}\n      <div className=\"relative max-w-md\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n        <Input\n          placeholder=\"Buscar vídeos...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"pl-10 w-full\"\n        />\n      </div>\n\n      {/* Empty State */}\n      {filteredVideos.length === 0 && !searchTerm && (\n        <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n          <Video className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            Nenhum vídeo adicionado\n          </h3>\n          <p className=\"text-gray-600 mb-6\">\n            Comece adicionando vídeos do YouTube para organizar seus treinamentos\n          </p>\n        </div>\n      )}\n\n      {/* Empty Search State */}\n      {filteredVideos.length === 0 && searchTerm && (\n        <div className=\"text-center py-12\">\n          <Video className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            Nenhum vídeo encontrado\n          </h3>\n          <p className=\"text-gray-600\">\n            Tente ajustar sua busca ou adicione novos vídeos\n          </p>\n        </div>\n      )}\n\n      {/* Videos Grid */}\n      {filteredVideos.length > 0 && (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {filteredVideos.map((video) => (\n            <div key={video.id} className=\"bg-white rounded-lg shadow-sm border overflow-hidden\">\n              {/* Video Player */}\n              <div className=\"aspect-video\">\n                <YouTubeVideo url={video.youtubeUrl} mode=\"preview\" className=\"h-full\" />\n              </div>\n\n              {/* Video Info */}\n              <div className=\"p-4 space-y-3\">\n                <h3 className=\"font-semibold text-lg text-gray-900\">{video.title}</h3>\n                {video.description && (\n                  <p className=\"text-sm text-gray-600 line-clamp-2\">{video.description}</p>\n                )}\n\n                {/* Actions */}\n                <div className=\"flex gap-2 pt-2 border-t\">\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => trainingVideos.startEditing(video)}\n                  >\n                    <Pencil className=\"h-4 w-4 mr-2\" />\n                    Editar\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => {\n                      if (confirm('Tem certeza que deseja excluir este vídeo?')) {\n                        trainingVideos.deleteVideo(video.id)\n                      }\n                    }}\n                    className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    Excluir\n                  </Button>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Add Video Modal */}\n      <AddVideoSheet\n        isOpen={isAddVideoOpen}\n        onClose={() => setIsAddVideoOpen(false)}\n        onSubmit={handleAddVideo}\n      />\n    </div>\n  )\n}\n"
        }
      ]
    },
    {
      "name": "useTrainingVideos",
      "description": "Hook responsável pelo CRUD e persistência local dos vídeos.",
      "route": "cards/trainings/hook",
      "order": 1,
      "blocks": [
        {
          "id": "3c5d15a1-eac7-4d4d-9040-056e34ed3e42",
          "type": "code",
          "title": "useTrainingVideos.ts",
          "language": "typescript",
          "order": 0,
          "content": "import { useState, useEffect, useCallback } from 'react'\nimport { TrainingVideo, CreateTrainingVideoData, UpdateTrainingVideoData } from '@/types/training'\nimport { extractYouTubeVideoId, getYouTubeThumbnail, isValidYouTubeUrl } from '@/utils/youtube'\n\nconst STORAGE_KEY = 'training_videos'\n\nexport function useTrainingVideos() {\n  const [videos, setVideos] = useState<TrainingVideo[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [isCreating, setIsCreating] = useState(false)\n  const [isEditing, setIsEditing] = useState(false)\n  const [editingVideo, setEditingVideo] = useState<TrainingVideo | null>(null)\n\n  // Load videos from localStorage\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY)\n      if (stored) {\n        setVideos(JSON.parse(stored))\n      }\n    } catch {\n      setError('Erro ao carregar vídeos')\n    } finally {\n      setLoading(false)\n    }\n  }, [])\n\n  // Save videos to localStorage\n  const saveToStorage = useCallback((updatedVideos: TrainingVideo[]) => {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedVideos))\n      setVideos(updatedVideos)\n    } catch {\n      setError('Erro ao salvar vídeos')\n    }\n  }, [])\n\n  // Create new video\n  const createVideo = useCallback(async (data: CreateTrainingVideoData): Promise<TrainingVideo | null> => {\n    try {\n      if (!isValidYouTubeUrl(data.youtubeUrl)) {\n        setError('URL do YouTube inválida')\n        return null\n      }\n\n      const videoId = extractYouTubeVideoId(data.youtubeUrl)\n      if (!videoId) {\n        setError('Não foi possível extrair ID do vídeo')\n        return null\n      }\n\n      const newVideo: TrainingVideo = {\n        id: `video-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        title: data.title,\n        description: data.description,\n        youtubeUrl: data.youtubeUrl,\n        videoId,\n        thumbnail: getYouTubeThumbnail(videoId),\n        category: data.category,\n        tags: data.tags || [],\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      }\n\n      const updatedVideos = [newVideo, ...videos]\n      saveToStorage(updatedVideos)\n      setError(null)\n      return newVideo\n    } catch {\n      setError('Erro ao criar vídeo')\n      return null\n    }\n  }, [videos, saveToStorage])\n\n  // Update video\n  const updateVideo = useCallback(async (id: string, data: UpdateTrainingVideoData): Promise<TrainingVideo | null> => {\n    try {\n      const videoIndex = videos.findIndex(v => v.id === id)\n      if (videoIndex === -1) {\n        setError('Vídeo não encontrado')\n        return null\n      }\n\n      let videoId = videos[videoIndex].videoId\n      let thumbnail = videos[videoIndex].thumbnail\n\n      if (data.youtubeUrl && data.youtubeUrl !== videos[videoIndex].youtubeUrl) {\n        if (!isValidYouTubeUrl(data.youtubeUrl)) {\n          setError('URL do YouTube inválida')\n          return null\n        }\n\n        const newVideoId = extractYouTubeVideoId(data.youtubeUrl)\n        if (!newVideoId) {\n          setError('Não foi possível extrair ID do vídeo')\n          return null\n        }\n\n        videoId = newVideoId\n        thumbnail = getYouTubeThumbnail(newVideoId)\n      }\n\n      const updatedVideo: TrainingVideo = {\n        ...videos[videoIndex],\n        ...data,\n        videoId,\n        thumbnail,\n        updatedAt: new Date().toISOString()\n      }\n\n      const updatedVideos = [...videos]\n      updatedVideos[videoIndex] = updatedVideo\n      saveToStorage(updatedVideos)\n      setError(null)\n      return updatedVideo\n    } catch {\n      setError('Erro ao atualizar vídeo')\n      return null\n    }\n  }, [videos, saveToStorage])\n\n  // Delete video\n  const deleteVideo = useCallback(async (id: string): Promise<boolean> => {\n    try {\n      const updatedVideos = videos.filter(v => v.id !== id)\n      saveToStorage(updatedVideos)\n      setError(null)\n      return true\n    } catch {\n      setError('Erro ao deletar vídeo')\n      return false\n    }\n  }, [videos, saveToStorage])\n\n  const getVideoById = useCallback((id: string): TrainingVideo | null => {\n    return videos.find(v => v.id === id) || null\n  }, [videos])\n\n  const startCreating = useCallback(() => {\n    setIsCreating(true)\n    setEditingVideo(null)\n  }, [])\n\n  const cancelCreating = useCallback(() => {\n    setIsCreating(false)\n  }, [])\n\n  const startEditing = useCallback((video: TrainingVideo) => {\n    setEditingVideo(video)\n    setIsEditing(true)\n  }, [])\n\n  const cancelEditing = useCallback(() => {\n    setIsEditing(false)\n    setEditingVideo(null)\n  }, [])\n\n  const clearError = useCallback(() => {\n    setError(null)\n  }, [])\n\n  return {\n    videos,\n    loading,\n    error,\n    isCreating,\n    isEditing,\n    editingVideo,\n    createVideo,\n    updateVideo,\n    deleteVideo,\n    getVideoById,\n    startCreating,\n    cancelCreating,\n    startEditing,\n    cancelEditing,\n    clearError\n  }\n}\n"
        }
      ]
    }
  ]
}

